- alias: 'Uppdatering av home assistant finns'
  trigger:
    platform: state
    entity_id: updater.updater
  action:
    service: notify.pushover
    data:
      message: 'Ny version av HA finns'

- alias: 'Glömde låsa dörren notis'
  trigger:
    - platform: state
      entity_id: device_tracker.nexus_6p
      from: 'home'
      to: 'not_home'
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: lock.ytterdorren
        state: 'unlocked'
      - condition: state
        entity_id: device_tracker.honor_8
        state: 'not_home'
      - condition: state
        entity_id: device_tracker.nexus_6p
        state: 'not_home'
  action:
    - service: notify.html5
      data_template:
        message: 'Dörren är inte låst och ingen är hemma'
        target: "Pär telefon"
        data:
          tag: 'forgot-lock'
          actions:
            - action: 'lock_door'
              title: 'Lås dörren'

- alias: 'Välkommen hem notis'
  trigger:
    - platform: state
      entity_id: device_tracker.nexus_6p
      from: 'not_home'
      to: 'home'
  condition:
    condition: state
    entity_id: device_tracker.nexus_6p
    state: 'not_home'
    for:
      minutes: 10
  action:
    - service: notify.html5
      data:
        message: 'Välkommen hem'
        target: "Pär telefon"
        data:
          tag: 'unlock-door'
          actions:
            - action: 'unlock_door'
              title: 'Lås upp dörren'

- alias: "Notifiera ifall dörren är upplåst när kodi spelar"
  trigger:
    - platform: state
      entity_id: media_player.kodi
      to: 'playing'
  condition:
    condition: state
    entity_id: lock.ytterdorren
    state: 'unlocked' 
  action:
    - service: notify.html5
      data:
        message: 'Dörren är upplåst. Du kanske vill låsa när du ska sitta i källaren'
        target: "Pär telefon"
        data:
          tag: 'forgot-lock'
          actions:
            - action: 'lock_door'
              title: 'Lås dörren'

- alias: "Brandlarmet notis"
  trigger:
    - platform: event
      event_type: signal_received
      event_data: {"entity_id": "sensor.brandvarnare_2_sensor_status"}
  action:
    - service: notify.html5
      data:
        message: 'Brandlarmet utlöst!'
    - service: notify.pushover
      data:
        message: 'Brandlarmet utlöst!'

- alias: "Rörelse i källaren"
  trigger:
    - platform: state
      entity_id: binary_sensor.basement_entry
      to: 'on'
      from: 'off'
  condition:
    condition: state
    entity_id: group.device_tracker
    state: 'not_home'
  action:
    service: notify.pushover
    data:
      message: 'Rörelse upptäckt i källaringången'

- alias: "Ny enhet hittad notis"
  trigger:
    platform: event
    event_type: device_tracker_new_device
  action:
    - service: notify.pushover
      data:
        message: 'Ny enhet spåras'

- alias: "Kom ihåg matlåda notis"
  trigger:
    platform: time
    at: '07:30:00'
  condition:
    condition: and
    conditions:
      - condition: time
        weekday:
          - mon
          - tue
          - wed
          - thu
          - fri
      - condition: state
        entity_id: group.device_tracker
        state: 'home'
  action:
    - service: notify.html5
      data:
        title: 'Matlåda'
        message: 'Du glömmer väl inte  matlåda?'
        target: ["Malena telefon", "Pär telefon"]
